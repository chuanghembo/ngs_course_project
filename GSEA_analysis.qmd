## Load packages

```{r}
library(tidyverse)
library(fgsea)
library(msigdbr)
```

## Rank data

```{r}
data_path <- '../PP1DTLeukemia_vs_WTLeukemia_none_filtered.csv'
data <- read_csv(data_path)

ranked_genes <- data |>
        na.omit() |> 
        mutate(gene = str_remove(row, "\\..*")) |>
        mutate(rank = -log10(padj)) |> 
        arrange(-rank) |> 
        select(gene, rank)

gene_set
```

## Fetch geneset

```{r}
# Look at species
msigdbr_species() 

gene_set <- msigdbr(species = "Mus musculus",
                    category = 'C5',
                    subcategory = 'BP')

gene_set <- gene_set |> as.list()

gene_stat  <- ranked_genes |> 
        select(rank) |> 
        unlist() 

names(gene_stat) <- ranked_genes$gene

str(gene_stat)
```

```{r}
fgseaRes <- fgsea(pathways = gene_set, 
                  stats    = gene_stat)

fgseaRes
```
